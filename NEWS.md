# Changelog

## v1.32.4 - 2025-09-19

### Added
1. На вкладке **Логи** добавлена кнопка очистки app.Rout файла.
2. При запуске приложения теперь проверяется наличие файла конфигурации и базы данных, при их отсутвии создаётся дефолтный вариант конфигурации и разворачивается пустая база для старта.

## v1.32.3 - 2025-09-18

### Added
Приложению добавлен вывод STDout логов в файл app.Rout, содержимое файла можно смотреть на вкладке **Логи**.

## v1.32.2 - 2025-09-13

### Added
В интерфейс приложения добавлена информация о залогиненом пользовтаеле.

## v1.32.1 - 2025-09-12

### Added
На вкладку **Статистика** добавлена таблица "Количество сбоев по задачам".

## v1.32.0 - 2025-09-10

### Added
Доработана вкладка просмотра логов задач на вкладке **Задачи**.

В связи с тем, что был доработан процесс мониторинга ошибок выполнении скриптов, а именно, теперь в случае сбоя в каком либо из скриптов запускаемом из планировщика заданий, его Rout файл с ошибкой выполнения копируется в отдельную папку `rout_error_history`. Данная папка автоматически появляется в корневой папке проекта.
В интерфейсе приложения при запросе лога теперь появляется выпадающий список позволяющий выбрать любой из перенесённых в папку `rout_error_history` логов, название файла начинается с даты и времени копирования лога в папку `rout_error_history`.

![](http://img.netpeak.ua/alsey/1TEAVYZ.png)

## v1.31.1 - 2025-09-09

### Added
На вкладку **Логи** добавлена кнопка обновления логов.

## v1.31.0 - 2025-09-09

### Changed
Вкладка **AI Ассистент** выделена в отдельный модуль приложения.

## v1.30.2 - 2025-09-05

### Changed
Небольшие изменения интерфейса вкладки **Задачи**:
- Область фильтра выведена на верх интерфейа и теперь имеет горизонтальную ориентацию.
- Область вкладок теперь отображается сразу при загрузке приложения, и она стала шире и длиннее для удобства чтения кода, логов и прочей информации.

## v1.30.1 - 2025-09-05

### Changed

На вкладке **Задачи** перенёс рендинг README в общую область вывода информации о задаче, там же где Анализ кода, Анализ Rout, Логи.

## v1.30.0 - 2025-09-04

### Added
- В конфиг приложеня добавлена возможность упрадения логированием данных и хранением данных приложения.
- Всё управление конфигом выведено на вкладку **Доступы**.

## v1.29.0 - 2025-09-04

### Added
- На вкладке **Доступ** теперь появился блок управления доступа к вкладкам и кнопкам в приложении для различных ролей пользователей. В приложение добавлен конфиг, из которого на данный момент идёт управление доступа к функционалу приложения для различных ролей пользователей, вкладка **Доступ** позволяет редактировать конфиг из интерфейса.

### Fixed
- На вкладке логи исправлено оформления календаря для выбора периода, теперь он корректно оторажается в тёмной теме. Его стили выведены в отдельный файл calendar.css.

## v1.28.2 - 2025-09-03

### Changed
Теперь даже через AI ассистента запускать задачи могут только пользователи с ролью admin и user. Пользователи с ролью viewer не могут запустить задачу даже через AI ассистента.

## v1.28.1 - 2025-09-02

### Changed
Небольшие изменения в интерфейсе:
- На вкладке **Задачи** вернул полное описание кнопок, изменил цвета и иконки некоторых кнопок.
- На вкладке **Логи** переместил таблицу логов ошибок сразу под таблицы логов сессий и действий.

### Added
- На вкладке **Логи** добавлена фильтрация, выбирая строку в таблице ошибок теперь вы фильтруете таблицы сессий и логов.

### Added

## v1.28.0 - 2025-09-02

### Changed

Улучшен интерфейс вкладки **Задачи**, изменения коснулись блока "Управления задачами":
- Добавлены кнопки активации и деактивации задач
- Добавлена кнопка чтения NEWS
- Кнопки разделены на 2 строки, вверху кнопки управления, внизу кнопки запроса информации

## v1.27.0 - 2025-09-02

### Added

В приложении добавлено логирование ошибок.
На вкладку **Логи** в отдельную таблицу добавлена информация из лога ошибок.

## v1.26.2 - 2025-09-02

### Added

На вкладку **Логи** добавлено время загрузки информации о логах.

### Changed

* Поменял расположение вкладок, так что бы сначало шли все функциональные вкладки (задачи, службы, ассистент, поиск по файлам, процессы, CMD), а уже за ними все информационные (статистика, логи, readme? news).
* Поменял тему всех графиков приложения на "flat dark"

## v1.26.1 - 2025-09-02

### Added

На вкладку **Логи** добавлены 2 таблицы, для анализа активности пользователей, и используемого в приложении функционала:

* Активность пользователей
* Использование функционала

## v1.26.0 - 2025-09-01

### Added

В интерфейс приложения добавлена вкладка "Логи", на которой видна информация об использовании приложения пользователями:

- К-во сессий
- Длительность сессий
- К-во уникальных пользователей
- К-во событий
- Подробная информация по каждой отдельной сессии
- Графики активности использования приложения

## v1.25.1 - 2025-08-30
 
### Added

Улучшен процесс логирования, теперь помимо действий фиксируются и значения используемые функциями. Например, при запросе логи задачи фиксируется название задачи, при добавлении нового пользовтеля фиксируется его логин и т.д. 

## v1.25.0 - 2025-08-28

### Added

В приложение добавлен функционал логированния. 

На данный момент пишется 2 лога:

1. Лог сессий, в котором фиксируется старт и завершение каждой пользовательской сессии приложения.
2. Лог действий, в который фиксируется использование всех используемых в ходе пользовательской сессии функций приложения.

## v1.24.0 - 2025-08-27

### Added

Доработано окно задач, которое появляется по двойному клику на строке таблицы задач, на вкладке **Задачи**.

- Появилась кнопка дял удобного копирования названия задачи
- Появились кнопки активации и деактивации задачи в планировщике заданий (доступно только пользователям с ролями admin и user)

## v1.23.1 - 2025-08-27

### Added

- В popup который появляется при двойном клике по таблице задач на вкладке **Задачи** добавлена кнопка запуска выбранной задачи.

### Fixed

- Исправлена проблема возникающая при клике на таблицу задач для появления popup, если к таблице были применены какие либо фильтры, или переключения на другую страницу задач то в popup ранее попадала неверная задача.

## v1.23.0 - 2025-08-22

### Added

- На вкладке **Поиск по файлам** к таблице результатов добавлены 2 поля:
    - `TaskName` - Название задачи в планировщике, которая запускает найденный скрипт
    - `TaskState` - Состояние задачи, которая запускает скрипт

## v1.22.6 - 2025-08-22

### Added

- На вкладке **Поиск по файлам** добавлена возможность выбирать типы файлов для поиска, ранее по умолчанию поиск осуществлялся только по файлам `.R` и `.py`.

## v1.22.6 - 2025-08-22

### Added

- На вкладке **Задачи** по клику на тублицу задач открывается popup с основной информацией по выбранной задаче.

## v1.22.5 - 2025-08-22

### Changed

- Из всех таблиц на вкладках **Задачи**, **Службы**, **Статистика** отключён жффект выделения строк синим цветом при клике на таблицу.

### Added

- На вкладке **Поиск по файлам** при клике на строку автоматически копируется в буфер обмена название файла, из строки по которой был клик.

## v1.22.4 - 2025-08-21

### Added

- На вкладке **Задачи** в блоке "Информация по задаче" в разделе "Наличие элементов проект" добавлен индикатор наличия лога в проекте.
- На вкладку **Статистика** так же добавлена информация по наличию логов в проекте как в общем блоке, так и в таблице по авторам скриптов.

## v1.22.3 - 2025-08-21

### Added

На вкладку **Статистика** добавлена таблица с анализом наличия элементов проекта (README, NEWS, Git, Rproj) в разрезе авторов. Так же информация добавлена в общий блок вкладки **Статистика**.

![](http://img.netpeak.ua/alsey/1QI5G3A.png)

## v1.22.2 - 2025-08-21

### Added

На вкладке **Задачи** в блок "Информация по задаче" добавлена информация о наличие элементов проекта: README, NEWS, Git, Rproj.

![](http://img.netpeak.ua/alsey/1QI57RU.png)

## v1.22.1 - 2025-08-20

### Added

На вкладке **AI Ассистент** добавлена кнопка "Сбросить чат", по нажатию на которую ассистент забывает весь предыдущий контекст диалога, при этом все старые сообщения вы будете по прежнему видеть, но ассистент о них помнить не будет.

## v1.22.0 - 2025-08-19

### Changed

Улучшен процесс загрузки и обновления данных, теперь данные по задачам из планировщика, службам Windows и запущенным процессам загружаются при старте, и обновляются в параллельном режиме, что значительно ускоряет процесс запуска приложения и обновления данных.
На вкладках **Задачи**, **Службы** и **Процессы** добавлена информация о дате и времени обновления данных.

## v1.21.2 - 2025-08-19

### Added

На вкладки **README** и **AI Ассистент** добавлены ссылки на [видео мануал](https://youtu.be/sQRPMJYIxMA) по работе с AI Ассистентом.

## v1.21.1 - 2025-08-14

### Fixed

Починил работу кнопки выгрузки таблицы кронов в Google Sheets на вкладке **Задачи**.

### Changed

Переименовал вкладку **AI разработка** в **AI Ассистент**.

### Added

Добавил приветвенное сообщение AI ассистенту.

## v1.21.0 - 2025-08-12

### Added

AI ассистенту добавлена возможность читать данные по задачам из Планфикса по ссылке на задачу.

## v1.20.4 - 2025-08-08

### Added

AI ассистенту добавлена возможность получить текущую дату, надо для того что бы он понимал какой сейчас спринт.

## v1.20.3 - 2025-08-05

### Added

На вкладке "Задачи" в блок "Информация о задаче" добавлено поле с названием задачи и кнопкой для быстрого копирования названия задачи.

### Fixed

Исправлена проблема возникающая при чтении информации о процессах, если процесс в ходе старта приложения был активным, но при чтении данных о процессах уже отключился. Процесс загрузки приложения стал более стабильным.

## v1.20.2 - 2025-08-05

### Changed

Ассистент на вкладке "AI разработка переведён на новую версию пакета `ellmer` версии 0.3.0".
Изменения коснулись функционала добавления в чат инструментов `tool()`.

## v1.20.1 - 2025-07-25

### Added

На вкладку "Задачи" добавлен фильтр Responsible, который позволяет фильтровать таблицу задач по ответвенным.

## v1.20.0 - 2025-07-24

### Added

Доработан ассистент на вкладке "AI Разработка".

Асситент теперь умеет показывать информацию по любому спринту команды аналитиков, и формировать отчёты по юнит экономике.

## v1.19.1 - 2025-07-17

### Added

Доработан ассистент на вкладке "AI Разработка".

Асситент теперь умеет активировать и деактивировать задачи в планировщике заданий Windows на сервере аналитики.


## v1.19.0 - 2025-07-10

### Added

Доработан ассистент на вкладке "AI Разработка"

Были добавлены новые возможности ассистенту и доработан системный промпт. 

1. Теперь ассистент умеет по запросу пользователя искать нужную задачу в планировщике, а так же при необходимости запускать её на сервере.

Пример работы с добавленным функционалом: 

![](http://img.netpeak.ua/alsey/1KIOVUW.png)

2. В системном промпте прописано то как ассистент должен работать с задаче в планировщике заданий Windows на сервере аналитики.

## v1.18.0 - 2025-07-10

### Added

Доработан ассистент на вкладке "AI Разработка"

1. Асситент теперь по названию задачи умеет искать и анализировать листинг кода запускаемой задачи
2. Ассистент теперь умеет искать общую информацию по задаче в планировщике Windows
3. Ассистент умеет проверять есть ли упавшие задачи, анализировать их логи и код, и помогать исправить ошибки

Пример работы с добавленным функционалом: 

![](http://img.netpeak.ua/alsey/1KI683C.png)

## v1.17.0 - 2025-07-09

### Added

- Доработан ассистент на вкладке **"AI разработка"**:
Теперь он умеет по названию задачи из планировщика Windows находить на сервере нужный лог выполнения скрипта, и отвечать на вопросы по нему:

![](http://img.netpeak.ua/alsey/1KDTQ1H.png)

## v1.16.1 - 2025-07-04

### Changed

- Установлена опция `ellmer_timeout_s`, теперь приложение ждёт ответ от API до 10 минут.
- Приложение переведено на работу с `ellmer 0.2.1`
    - Перевод со старого названия функций `chat_gemini()` → `chat_google_gemini()`

## v1.16.0 - 2025-07-04

### Added

- Теперь в приложение загружается полный список задачь из планировщика, как активные так и выключенные.
- На вкладку **"Задачи"** добавлен фильтр **Scheduled Task State**, который позволяет выводить в таблицу включённые или выключенные задачи. По умолчанию как и раньше в таблице выводятся только активные задачи из планировщика.

## v1.15.2 - 2025-05-07

### Changed
- Улучшен процесс поиска логов, если всеми заданными ранее способами не удалось найти лог, то приложение начинает искать последний изменённый файл с расширением `.log`.
- Расширено описание кодов ошибок в планировщике заданий.

## v1.15.1 - 2025-05-06

### Fixed
- Исправлена работа фильтров на вкладке "Процессы". Ранее фильтр по директории вообще не работал.

## v1.15.0 — 2025-04-26

### Added
- На вкладку **"Задачи"** добавлена кнопка **"Объясни код"**.  
  По нажатию код R-скрипта, связанного с выбранной задачей планировщика, отправляется в Gemini AI для анализа.  
  Результат выводится на новой вкладке **"Анализ кода"** в формате подробного объяснения логики скрипта.

## v1.14.0 — 2025-04-25

### Added
- На вкладку **"Задачи"** добавлена кнопка **"Код"** для просмотра листинга скрипта, запускаемого выбранной задачей.
- Проведено дополнительное обучение модели, используемой в чатах и при анализе `.Rout` файлов:
  - Добавлена расширенная информация о пакете **n1**:
    - Описание статусов сотрудников.
    - Описание всех аргументов всех функций.
  - Обновлены описания пакетов **`rpup`** и **`n1`**:
    - Добавлены списки названий компаний для корректной фильтрации.
  - Добавлена информация по работе с Python-пакетом **`alspy`** и классом **`PyPup`**:
    - Описания всех методов класса.
    - Описания всех аргументов методов.
    - Описания основных полей возвращаемых данных.
    - Инструкция по применению класса **PyPup** в различных сценариях.
  - В модель добавлено описание общей концепции и принципов нашей разработки.

### Changed
- У приложения обновлён favicon.
- При отправке `.Rout` файлов на анализ теперь передаются только последние 30 000 символов, чтобы оптимизировать скорость обработки и избежать перегрузки модели избыточной информацией.

## v1.13.0 — 2025-04-19

### Added

- Добавлена вкладка "AI разработка" — интерфейс к AI-модели Gemini, позволяющий генерировать R-код с использованием внутренних пакетов:
  - rpup
  - n1
  - pfworker
  - serviceaccounts
  - segments
- Встроенная в приложение AI-модель дообучена:
  - Загружено описание всех внутренних функций, включая:
    - Все аргументы каждой функции
    - Перечень таблиц базы данных, к которым обращается функция
    - Описание всех полей, которые функция возвращает
- На вкладку README добавлен видео мануал.

## v1.12.1 — 2025-04-18

### Added

- При запуске приложения для анализа Rout логов теперь создаётся диалог с Gemini AI в который загружается базовая документация к внутренним пакетам: rpup, pfworker, n1, serviceaccounts, segments. Далее эта информация используется при отправке Rout файлов на анализ через AI.

## v1.12.0 — 2025-04-18

### Added

- На вкладку "Задачи" добавлена кнопка "Анализ Rout", по нажатию на которую Rout файл по выбранной задаче отправляется на анализ Gemini AI. В результате вы получите рекомендации с пошаговым планом по исправлению ошибки в упавшем скрипте.

## v1.11.0 — 2025-04-12

### Added

- На вкладку "Задачи" добавлена кнопка "Выгрузить в Google Sheets", по нажатию на которую отфильтрованный список задач выгружается в докс, и появляется кнопка открыть задачи в Google Sheets.

## v1.10.4 — 2025-04-10

### Changed

- Улучшен процесс поиска логов:
  - Если ряд скриптов запускаются из одного bat файла будут выведены логи по каждому Rout файлу, при этом сначала в лог выводятся все Rout файлы и время их последнего изменения.
  - Загружаются логи даже если скрипты запускаются из ps1 файла.

## v1.10.3 — 2025-04-10

### Added

- В приложение добавлена новая роль пользователя viewer. У пользователей в данной роли нет доступа к вкладкам:
  - CMD
  - Процессы
  - Поиск по файлам
  - Доступы
  - На вкладке Задачи нет кнопки запуска задач.
  - На вкладке Службы нет кнопок управления службами.

## v1.10.2 — 2025-04-10

### Changed

- Доработан интерфейс вкладки Процессы:
  - Добавлены фильтры по полям имя процесса и клиент.
  - В таблице процессов добавлены фильтры под каждое поле.
  - Все фильтры теперь взаимосвязаны, т.е. при выборе значения в одном, изменяются список доступных значений в остальных фильтрах.

### Fixed

- Исправлено вычисления поля client в таблице процессов.

## v1.10.1 — 2025-04-10

### Added

- Отображение пользовательского экрана загрузки (через waiter) в процессе запуска приложения и обновления данных.

## v1.10.0 — 2025-04-10

### Added

- Вкладка Процессы с возможностью отслеживания и остановки процессов на сервере.
- Новый модуль mod_tab_processes.

## v1.9.6 — 2025-04-09

### Added

- Вкладки README и NEWS для отображения технической документации в интерфейсе.

## v1.9.5 — 2025-04-09

### Changed

- Вынесен код вкладки Задачи в модуль mod_tab_tasks.

## v1.9.4 — 2025-04-09

### Changed

- Вкладка Поиск по файлам вынесена в модуль mod_tab_find_in_files.

## v1.9.3 — 2025-04-09

### Changed

- Кнопка Выйти перемещена вверх, добавлена иконка и цвет danger.
- Галочка "Светлая тема" заменена на кнопку с иконкой луны/солнца.
- Кнопка Обновить данные теперь жёлтого цвета.

## v1.9.2 — 2025-04-09

### Changed

- Вкладка Службы вынесена в модуль mod_tab_services.

## v1.9.1 — 2025-04-09

### Fixed

- Улучшена обработка логов для задач с .bat файлами (чтение из файла).

## v1.9.0 — 2025-04-08

### Added

- Модуль управления пользователями (виден только admin).
- Возможность добавления, удаления и редактирования ролей и паролей.
- Достигнута первая стабильная версия.

## v1.8 — 2025-04-08

### Added

- Расшифровка статусов задач и кодов ошибок из планировщика для более понятного отображения информации о задачах.

## v1.7 — 2025-04-07

### Added

- Кнопка README на вкладке "Задачи" для рендеринга и отображения содержимого README.md файла проекта.
- Вкладка "Поиск по файлам" для поиска файлов по тексту во всех директориях, где находятся скрипты.
- Интерфейс командной строки для выполнения команд на сервере.
- Общая информация по задаче под выпадающим списком в интерфейсе задач.

### Changed

- Увеличена ширина поля с выбором задачи для удобства использования.
- Перемещены кнопка "Обновить данные" и элемент управления темой для улучшения интерфейса.
- Функционал поиска по файлам теперь отображает полный путь к файлу в поле file.
- Функции из файла app.R вынесены в каталог R.
- Модуль авторизации вынесен из app.R в отдельный модуль.

## v1.6 — 2025-04-07

### Added

- Вкладка "Поиск по файлам" для поиска файлов по тексту во всех директориях, где находятся скрипты.

### Changed

- Увеличена ширина поля с выбором задачи.

## v1.5 — 2025-04-06

### Added

- Интерфейс командной строки для выполнения команд на сервере.

### Changed

- Улучшена логика работы интерфейса командной строки.

## v1.4 — 2025-04-06

### Added

- Дополнительная информация о службах: директория запуска, клиент, команда.
- Favicon для приложения.
- Окно авторизации с поддержкой тёмной темы.

### Changed

- Улучшена логика отклика нажатия кнопок для повышения производительности.
- Оптимизирована работа окна авторизации.

## v1.3 — 2025-04-06

### Added

- Авторизация по логину и паролю для доступа к приложению.

### Changed

- Оптимизирована логика отклика нажатия кнопок.

## v1.2 — 2025-04-06

### Added

- Вкладка "Статистика" с информацией о задачах в разрезе пользователей и клиентов.
- Два графика на вкладке "Статистика":
  - График количества сбоев по задачам за последние 90 дней.
  - График количества настроенных кронов на сервере.
- Процесс авторизации по логину и паролю.

## v1.1 — 2025-04-06

### Changed

- Исправлена логика определения поля Client для задач, исключая ошибки при работе со старой файловой структурой.

## v1.0 — 2025-04-06

### Added

- Первый релиз Server Task & Service Manager Shiny App.
- Интерфейс разделён на две вкладки:
  - "Задачи" — управление задачами в планировщике Windows.
  - "Службы" — управление службами на сервере.
- Возможности:
  - Просмотр списка задач с фильтрацией по автору и статусу последнего запуска.
  - Запуск выбранной задачи.
  - Мониторинг статуса служб.
  - Запуск, остановка и перезапуск служб.
  - Запрос логов задач.
  - Отображение информации о клиенте, связанном со скриптом.
- Тёмная тема интерфейса.
- Кнопка "Обновить данные" для актуализации информации.
- Блок вывода логов.

### Changed

- Оптимизирована загрузка данных по задачам (с 4 запросов до 1 при старте).
- Изменено расположение блоков интерфейса для удобства использования.
